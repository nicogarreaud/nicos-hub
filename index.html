<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Nico's Hub</title>

  <!-- 1) Agrega aquí el SDK de Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    /* Variables de color para modo oscuro/claro (si ya lo tenías, mantenlas) */
    :root {
      --bg: #f9f9f9; --fg: #333; --card-bg: #fff;
      --header-bg: #111827; --header-fg: #fff;
      --nav-bg: #e5e7eb; --nav-link-bg: #f3f4f6; --nav-link-fg: #1f2937;
      --btn-bg: #111827; --btn-fg: #fff; --btn-hover-bg: #1f2937;
    }
    [data-theme="dark"] {
      --bg: #1e1e2e; --fg: #e0e0e0; --card-bg: #2e2e3e;
      --header-bg: #0f0f1f; --header-fg: #e0e0e0;
      --nav-bg: #2e2e3e; --nav-link-bg: #3e3e4e; --nav-link-fg: #e0e0e0;
      --btn-bg: #3e3e4e; --btn-fg: #e0e0e0; --btn-hover-bg: #5e5e7e;
    }

    body {
      margin: 0; font-family: 'Segoe UI', sans-serif;
      background: var(--bg); color: var(--fg);
    }
    header {
      background: var(--header-bg); color: var(--header-fg);
      padding: 1rem 2rem; font-size: 1.5rem; font-weight: bold;
      position: relative;
    }
    #theme-toggle {
      position: absolute; right: 1.5rem; top: 1rem;
      background: none; border: none; font-size: 1.2rem; cursor: pointer;
      color: var(--header-fg);
    }
    nav {
      background: var(--nav-bg); padding: 1rem;
      display: flex; gap: 1rem; flex-wrap: wrap;
      border-bottom: 1px solid #d1d5db;
    }
    nav a {
      background: var(--nav-link-bg); color: var(--nav-link-fg);
      padding: 0.5rem 1rem; border-radius: 0.5rem;
      text-decoration: none; transition: .2s;
    }
    nav a:hover { background: #d1d5db; }

    section { padding: 2rem; }
    .section-title { font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem; }
    .card {
      background: var(--card-bg); padding: 1rem; border-radius: 0.5rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 2rem;
    }

    /* Planner */
    #planner-controls {
      display: flex; flex-wrap: wrap; gap: .5rem; align-items: center;
      margin-bottom: 1rem;
    }
    #planner-controls button {
      background: var(--btn-bg); color: var(--btn-fg);
      border: none; padding: .5rem 1rem; border-radius: .25rem;
      cursor: pointer;
    }
    #planner-controls button:hover { background: var(--btn-hover-bg); }
    #week-range, #progress { font-weight: bold; }
    #quote { font-style: italic; margin-left: auto; }

    table {
      width: 100%; border-collapse: collapse; margin-top: 1rem;
    }
    th, td {
      border: 1px solid #ddd; padding: .75rem; text-align: left;
    }
    th { background: #f3f4f6; }
    input[type="checkbox"] { transform: scale(1.2); margin-right: .5rem; }

    /* Notas */
    .note-input { width:100%; min-height:3rem; padding:.5rem; margin-bottom:.5rem;
                  border:1px solid #ccc; border-radius:.25rem; }
    .note-btn {
      background: var(--btn-bg); color: var(--btn-fg); border:none;
      padding:.5rem 1rem; border-radius:.25rem; cursor:pointer;
    }
    .note-btn:hover { background: var(--btn-hover-bg); }
    .notes-list { list-style:none; padding:0; }
    .notes-list li {
      background:#f3f4f6; padding:.5rem; border-radius:.25rem;
      margin-bottom:.5rem; display:flex; align-items:center; justify-content:space-between;
    }
    .note-date { font-size:.85rem; color:#555; margin-right:.5rem; }
    .note-actions button {
      margin-left:.5rem; padding:.25rem .5rem; border:none; border-radius:.25rem;
      cursor:pointer;
    }
    .edit-note { background:#3b82f6; color:#fff; }
    .delete-note { background:#ef4444; color:#fff; }
  </style>
</head>
<body>

  <header>
    Nico's Hub
    <button id="theme-toggle" title="Cambiar tema">🌙</button>
  </header>

  <nav>
    <a href="#planner">🗓 Planner</a>
    <a href="#tfm">📚 TFM Zone</a>
    <a href="#energie">🏋️ Énergie Tasks</a>
    <a href="#music">🎶 Music Corner</a>
    <a href="#croata">🗣️ Croata Diario</a>
    <a href="#otros">📂 Otros Proyectos</a>
  </nav>

  <!-- PLANNER -->
  <section id="planner">
    <div class="section-title">🗓 Planner Diario/Semanal</div>
    <div class="card">
      <div id="planner-controls">
        <button id="prev-week">&larr; Semana anterior</button>
        <div id="week-range">Cargando…</div>
        <button id="next-week">Semana siguiente &rarr;</button>
        <div id="progress">Progreso: 0%</div>
        <div id="quote"></div>
      </div>
      <table id="planner-table">
        <thead>
          <tr>
            <th>Fecha</th><th>Día</th><th>Horario</th><th>Sugerencia</th><th>Hecho</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <!-- SECCIONES DE NOTAS -->
  <section id="tfm"    class="card-section"><div class="section-title">📚 TFM Zone</div>
    <div class="card">
      <textarea id="input-tfm" class="note-input" placeholder="Tu nota…"></textarea>
      <button id="add-tfm" class="note-btn">Agregar</button>
      <ul id="notes-tfm" class="notes-list"></ul>
    </div>
  </section>

  <section id="energie" class="card-section"><div class="section-title">🏋️ Énergie Tasks</div>
    <div class="card">
      <textarea id="input-energie" class="note-input" placeholder="Tu nota…"></textarea>
      <button id="add-energie" class="note-btn">Agregar</button>
      <ul id="notes-energie" class="notes-list"></ul>
    </div>
  </section>

  <section id="music"   class="card-section"><div class="section-title">🎶 Music Corner</div>
    <div class="card">
      <textarea id="input-music" class="note-input" placeholder="Tu nota…"></textarea>
      <button id="add-music" class="note-btn">Agregar</button>
      <ul id="notes-music" class="notes-list"></ul>
    </div>
  </section>

  <section id="croata"  class="card-section"><div class="section-title">🗣️ Croata Diario</div>
    <div class="card">
      <textarea id="input-croata" class="note-input" placeholder="Tu nota…"></textarea>
      <button id="add-croata" class="note-btn">Agregar</button>
      <ul id="notes-croata" class="notes-list"></ul>
    </div>
  </section>

  <section id="otros"   class="card-section"><div class="section-title">📂 Otros Proyectos</div>
    <div class="card">
      <textarea id="input-otros" class="note-input" placeholder="Tu nota…"></textarea>
      <button id="add-otros" class="note-btn">Agregar</button>
      <ul id="notes-otros" class="notes-list"></ul>
    </div>
  </section>

  <script>
    // ——— PLANNER ———
    const days = ['Lunes','Martes','Miércoles','Jueves','Viernes'];
    const scheduleBefore = {
      blocks: ['09:00-10:00','10:00-10:15','10:15-10:45','10:45-11:45','11:45-12:30'],
      suggestions: {
        Lunes: ['TFM','Break','Croata','Música','Almuerzo'],
        Martes:['Énergie','Break','Croata','TFM','Almuerzo'],
        Mié:   ['TFM','Break','Croata','Música','Almuerzo'],
        Jue:   ['Énergie','Break','Croata','TFM','Almuerzo'],
        Vie:   ['TFM/Énergie','Break','Croata','Libre','Almuerzo']
      }
    };
    // (similar scheduleAfter…)

    let weekOff=0, tbody=document.querySelector('#planner-table tbody'),
        rEl=document.getElementById('week-range'),
        pEl=document.getElementById('progress'),
        qEl=document.getElementById('quote'),
        quotes=['Recuerda por qué empezaste','Un paso…'];

    document.getElementById('prev-week').onclick=() =>{ weekOff--;rP(); };
    document.getElementById('next-week').onclick=() =>{ weekOff++;rP(); };

    function gWD(o){
      let n=new Date(),d=n.getDay(),diff=(d?1-d:-6)+o*7,
          m=new Date(n); m.setDate(n.getDate()+diff);
      return Array.from({length:5},(_,i)=>{let D=new Date(m);D.setDate(m.getDate()+i);return D.toISOString().split('T')[0];});
    }
    function rP(){
      tbody.innerHTML='';
      let dates=gWD(weekOff),total=0,done=0;
      rEl.textContent=`Semana: ${dates[0]} → ${dates[4]}`;
      dates.forEach((ds,i)=>{
        let name=days[i];
        scheduleBefore.blocks.forEach((b,bi)=>{
          total++;
          let id=`${ds}-${bi}`,tr=document.createElement('tr');
          tr.innerHTML=`<td>${ds}</td><td>${name}</td><td>${b}</td><td>${scheduleBefore.suggestions[name][bi]}</td><td><input type="checkbox" id="${id}"></td>`;
          tbody.appendChild(tr);
        });
      });
      tbody.querySelectorAll('input[type=checkbox]').forEach(cb=>{
        if(localStorage.getItem(cb.id)==='true'){cb.checked=true;done++;}
        cb.onchange=()=>{localStorage.setItem(cb.id,cb.checked);rP();};
      });
      let pct=total?Math.round(done/total*100):0;
      pEl.textContent=`Progreso: ${pct}% (${done}/${total})`;
      qEl.textContent=quotes[Math.floor(Math.random()*quotes.length)];
    }
    rP();

    // ——— FIREBASE ———
    const firebaseConfig = {
      apiKey: "AIzaSyB-BcypQo7cWL6jEWm_KVvMyNTN3Tgr204",
      authDomain: "nico-s-hub.firebaseapp.com",
      projectId: "nico-s-hub",
      storageBucket: "nico-s-hub.firebasestorage.app",
      messagingSenderId: "379085438498",
      appId: "1:379085438498:web:05fca04d37cbcc9cb7947b",
      measurementId: "G-7D6ZF24CJM"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ——— NOTAS EN FIRESTORE ———
    [
      {sec:'tfm',col:'notes-tfm'},
      {sec:'energie',col:'notes-energie'},
      {sec:'music',col:'notes-music'},
      {sec:'croata',col:'notes-croata'},
      {sec:'otros',col:'notes-otros'}
    ].forEach(({sec,col})=>{
      const inp=document.getElementById(`input-${sec}`),
            btn=document.getElementById(`add-${sec}`),
            list=document.getElementById(`notes-${sec}`);
      function load(){
        list.innerHTML='';
        db.collection(col).orderBy('timestamp','desc').get().then(snap=>{
          snap.forEach(doc=>{
            const d=doc.data(),
                  when=new Date(d.timestamp).toLocaleString(),
                  li=document.createElement('li');
            li.innerHTML=`<span class="note-date">[${when}]</span> ${d.text}`;
            list.appendChild(li);
          });
        });
      }
      btn.onclick=()=>{let t=inp.value.trim(); if(!t)return;
        db.collection(col).add({text:t,timestamp:Date.now()}).then(()=>{inp.value='';load();});
      };
      load();
    });

    // ——— MODO OSCURO/CLARO ———
    const tog=document.getElementById('theme-toggle'),
          saved=localStorage.getItem('theme')||'light';
    function apply(th){
      document.documentElement.setAttribute('data-theme',th);
      tog.textContent = th==='light'?'🌙':'☀️';
      localStorage.setItem('theme',th);
    }
    tog.onclick=()=> apply(document.documentElement.getAttribute('data-theme')==='light'?'dark':'light');
    apply(saved);
  </script>
</body>
</html>

